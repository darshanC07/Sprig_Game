/*
First time? Check out the tutorial game:
https://sprig.hackclub.com/gallery/getting_started

@title: Incredible
@author: 
@tags: []
@addedOn: 2024-00-00
*/
/*[ bg_sprite ,bitmap`
// 0000....0000....
// 0000....0000....
// 0000....0000....
// 0000....0000....
// ....0000....0000
// ....0000....0000
// ....0000....0000
// ....0000....0000
// 0000....0000....
// 0000....0000....
// 0000....0000....
// 0000....0000....
// ....0000....0000
// ....0000....0000
// ....0000....0000
// ....0000....0000` ],
[bg, map`
mmmmmm
mmmmmm
mmmmmm
mmmmmm
mmmmmm
mmmmmm`]*/
console.log("start");
const player = "p"
const trash = "t"
const dustbin = "b"

setLegend(
  [ player, bitmap`
................
................
.......000......
.......0.0......
......0..0......
......0...0.0...
....0003.30.0...
....0.0...000...
....0.05550.....
......0...0.....
.....0....0.....
.....0...0......
......000.......
......0.0.......
.....00.00......
................` ],
  [ trash, bitmap`
................
................
................
................
................
................
.....00000......
....C00C0C0.....
....00C0000.....
....0C0C0C0.....
....0000000.....
.....0C00C......
................
................
................
................` ],
  [ dustbin, bitmap`
................
................
................
................
..00000000000...
..0CCCCCCCCC0...
..0000.00.000...
...00.00.000....
...0.00.00.0....
...000.00.00....
...00.00.000....
...0.00.00.0....
...000.00.00....
...0.000.000....
...000000000....
................` ]

)

setSolids([player,trash])

let level = 0
const levels = [
  map`
..............
..............
.....p..t.....
..............
.....t........
.........b....`,
  map`
......
.tt.t.
.p.t.t
.t....
..t.t.
.t..b.`,
  
  
]

setMap(levels[level])

setPushables({
  [ player ]: [trash],
  [ trash ]: [trash]
})



onInput("s", () => {
  getFirst(player).y += 1
})
onInput("w", () => {
  getFirst(player).y -= 1
})
onInput("a", () => {
  getFirst(player).x -= 1
})
onInput("d", () => {
  getFirst(player).x += 1
})

/*code to reset the current level*/
onInput("j",()=>{
  setMap(levels[level]);
})

afterInput(() => {
  number_of_trash = getAll(trash).length
  addText("No. of trash \nremaining = "+number_of_trash,{
    x:0,
    y:2
  })
  
  const dustbin_x = getFirst(dustbin).x;
  const dustbin_y = getFirst(dustbin).y;
  console.log(dustbin_x, dustbin_y);
  const elements = getTile(dustbin_x, dustbin_y);
  // console.log(elements);
  if (elements.length>1){
    console.log("delete");
    if(elements[0].type != player){
    elements[0].remove();}
  }
  console.log(getAll(trash).length);
  /*checking is level is completed or not*/
  if (getAll(trash).length == 0){
    level+=1;
    setMap(levels[level])
  }
})
